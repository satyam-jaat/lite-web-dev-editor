<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VS Code-Like Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.39.0/min/vs/loader.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            background-color: #2f2f2f51;
            color: white;
        }

        .editor-container {
            margin: 10px;
            width: 55%;
            display: flex;
            flex-direction: column;
            background: #252526;
            border-right: 2px solid #444;
            border-radius: 10px;
            overflow: hidden;
            /* Ensure border-radius applies */
        }


        .tabs {
            display: flex;
            background: #333;
            padding: 8px;
            border-radius: 10px 10px 0 0;
            /* Top corners rounded */
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 4px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            color: white;
            font-weight: bold;
        }

        .tab.active {
            border-bottom: 1.5px solid #4caf50;
            background: #444;
        }


        #editor {
            flex-grow: 1;
            height: 100%;
            border-radius: 0 0 10px 10px;
            /* Bottom corners rounded */
            overflow: hidden;
            /* Prevent content from overflowing */
        }

        .output-container {
            width: 45%;
            padding: 10px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            /* Ensure border-radius applies */
        }

        #output {
            width: 100%;
            height: 91%;
            background: white;
            overflow: auto;
            border-radius: 10px;
        }


        .btn {
            margin: 10px;
            padding: 10px 20px;
            background: #4caf50;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            border-radius: 5px;
        }

        .btn:hover {
            background: #45a049;
        }
    </style>
</head>

<body>
    <div class="editor-container">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('html')">index.html</div>
            <div class="tab" onclick="switchTab('css')">style.css</div>
            <div class="tab" onclick="switchTab('js')">script.js</div>
        </div>
        <div id="editor"></div>
    </div>

    <div class="output-container">
        <button class="btn" onclick="applyChanges()">Apply Changes</button>
        <div id="output"></div>
    </div>

    <script>
        require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.39.0/min/vs' } });

        let editor;
        let files = {
            html: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Webpage</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Welcome to My Webpage</h1>
    </header>

    <main>
        <p>This is a simple webpage template.</p>
    </main>

    <footer>
        <p>&copy; 2025 My Website</p>
    </footer>
</body>
</html>`,
            css: `body {\n    background-color: lightblue;\n    font-family: Arial, sans-serif;\n}`,
            js: `console.log("Hello, World!");`
        };
        let currentFile = 'html';

        require(["vs/editor/editor.main"], function () {
            editor = monaco.editor.create(document.getElementById("editor"), {
                value: files[currentFile],
                language: "html",
                theme: "vs-dark",
                automaticLayout: true
            });
        });

        function switchTab(fileType) {
            files[currentFile] = editor.getValue();
            currentFile = fileType;
            if (editor) {
                editor.setValue(files[fileType]);
                monaco.editor.setModelLanguage(editor.getModel(), fileType === 'js' ? 'javascript' : fileType);
            }
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`.tab[onclick="switchTab('${fileType}')"]`).classList.add('active');
        }

        function applyChanges() {
            files[currentFile] = editor.getValue();
            let outputDiv = document.getElementById("output");

            // Clear previous content
            outputDiv.innerHTML = "";

            // Create iframe for sandboxed execution
            let iframe = document.createElement("iframe");
            iframe.style.width = "100%";
            iframe.style.height = "100%";
            outputDiv.appendChild(iframe);

            let doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.open();
            doc.write(`
                <html>
                <head>
                    <style>${files.css}</style>
                </head>
                <body>
                    ${files.html}
                    <script>${files.js}<\/script>
                </body>
                </html>
            `);
            doc.close();
        }
    </script>
</body>

</html>